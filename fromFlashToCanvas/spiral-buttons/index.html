<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Orbiting Sprites â€” Hover & Click</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        overflow: hidden;
        background: #000;
      }
      canvas {
        position: absolute;
        inset: 0;
        width: 100vw;
        height: 100vh;
        display: block;
      }
      #hud {
        pointer-events: none;
      }
      /* Info button + panel */
      #infoBtn {
        position: fixed;
        right: 14px;
        top: 14px;
        z-index: 10;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid rgba(140, 200, 255, 0.4);
        background: rgba(15, 22, 34, 0.72);
        color: #cfe8ff;
        font-weight: 800;
        cursor: pointer;
        backdrop-filter: blur(6px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.35);
      }
      #infoBtn:active {
        transform: scale(0.98);
      }
      #infoPanel {
        position: fixed;
        inset: 0;
        z-index: 9;
        display: none;
        background: rgba(0, 0, 0, 0.6);
      }
      #infoPanel.show {
        display: grid;
        place-items: center;
      }
      #infoPanel .card {
        width: min(92vw, 920px);
        max-height: 80vh;
        border: 1px solid rgba(140, 200, 255, 0.4);
        border-radius: 14px;
        background: rgba(15, 22, 34, 0.92);
        color: #d9e7ff;
        box-shadow: 0 18px 60px rgba(0, 0, 0, 0.6);
        overflow: auto;
        padding: 16px;
      }
      #infoPanel pre {
        white-space: pre-wrap;
        font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
        font-size: 14px;
        line-height: 1.5;
      }
    </style>
  </head>
  <body>
    <canvas id="bg"></canvas>
    <canvas id="sprites"></canvas>
    <canvas id="hud"></canvas>
    <button id="infoBtn" title="About" aria-label="About">i</button>
    <div id="infoPanel" aria-hidden="true" role="dialog" aria-modal="true">
      <div class="card"><pre id="infoText">Loadingâ€¦</pre></div>
    </div>
    <script>
      ;(() => {
        const bg = document.getElementById('bg')
        const spr = document.getElementById('sprites')
        const hud = document.getElementById('hud')
        const infoBtn = document.getElementById('infoBtn')
        const infoPanel = document.getElementById('infoPanel')
        const infoText = document.getElementById('infoText')
        const ctxB = bg.getContext('2d')
        const ctxS = spr.getContext('2d')
        const ctxH = hud.getContext('2d')

        let dpr = window.devicePixelRatio || 1
        let W = 0,
          H = 0,
          CX = 0,
          CY = 0

        function resize() {
          for (const c of [bg, spr, hud]) {
            c.width = c.clientWidth * dpr
            c.height = c.clientHeight * dpr
          }
          W = spr.width
          H = spr.height
          CX = W / 2
          CY = H / 2
          drawBackground()
        }
        window.addEventListener('resize', resize)

        function drawBackground() {
          // Solid black background for bg canvas
          ctxB.fillStyle = '#000'
          ctxB.fillRect(0, 0, W, H)
          for (let i = 0; i < 300; i++) {
            ctxB.fillStyle = `rgba(255,255,255,${Math.random() * 0.4})`
            ctxB.fillRect(Math.random() * W, Math.random() * H, 1, 1)
          }
        }

        const palette = [
          '#ff004c',
          '#00d8ff',
          '#a0ff00',
          '#ffa500',
          '#cc00ff',
          '#fffa00'
        ]
        const sprites = [],
          pulses = []
        function rand(a, b) {
          return a + Math.random() * (b - a)
        }
        function pick(a) {
          return a[(Math.random() * a.length) | 0]
        }
        function createSprite(o = {}) {
          return {
            r: o.r ?? rand(60, 300),
            angle: o.angle ?? Math.random() * Math.PI * 2,
            speed: o.speed ?? rand(0.005, 0.02),
            color: o.color ?? pick(palette),
            size: o.size ?? rand(4, 10),
            x: CX,
            y: CY,
            scale: 1
          }
        }
        for (let i = 0; i < 40; i++) sprites.push(createSprite())

        function drawHUD() {
          ctxH.clearRect(0, 0, W, H)
          ctxH.font = `${14 * dpr}px monospace`
          ctxH.fillStyle = '#0ff'
          ctxH.fillText(`Sprites: ${sprites.length}`, 20 * dpr, 30 * dpr)
        }

        // ðŸ”¥ Animate
        let hovered = null
        function tick() {
          ctxS.fillStyle = 'rgba(0,0,0,0.2)'
          ctxS.fillRect(0, 0, W, H)
          for (const s of sprites) {
            s.x = CX + Math.cos(s.angle) * s.r
            s.y = CY + Math.sin(s.angle) * s.r
            // smooth scale interpolation
            // when hovered, grow to +50%; otherwise 1x
            s.scale += ((s === hovered ? 1.5 : 1) - s.scale) * 0.1
            const radius = s.size * s.scale
            ctxS.beginPath()
            ctxS.fillStyle = s.color
            ctxS.shadowColor = s.color
            ctxS.shadowBlur = 15 * dpr
            ctxS.arc(s.x, s.y, radius, 0, Math.PI * 2)
            ctxS.fill()
            s.angle += s.speed
          }
          drawHUD()
          requestAnimationFrame(tick)
        }

        function getPointer(evt) {
          const r = spr.getBoundingClientRect()
          return {
            x: (evt.clientX - r.left) * dpr,
            y: (evt.clientY - r.top) * dpr
          }
        }

        spr.addEventListener('pointermove', e => {
          const p = getPointer(e)
          hovered = null
          for (const s of sprites) {
            const dx = p.x - s.x,
              dy = p.y - s.y
            if (dx * dx + dy * dy < (s.size * 1.5) ** 2) {
              hovered = s
              break
            }
          }
        })

        spr.addEventListener('pointerleave', () => (hovered = null))

        spr.addEventListener('click', e => {
          const p = getPointer(e)
          for (const s of sprites) {
            const dx = p.x - s.x,
              dy = p.y - s.y
            if (dx * dx + dy * dy < (s.size * 2) ** 2) {
              // reverse orbit direction
              s.speed *= -1
              // spawn a new sprite same direction
              const ns = createSprite({
                r: s.r + rand(-30, 30),
                angle: s.angle + Math.PI / 2,
                speed: Math.sign(s.speed) * Math.abs(rand(0.005, 0.02)),
                color: pick(palette)
              })
              sprites.push(ns)
              pulses.push({ x: s.x, y: s.y, r: 5, color: s.color, t: 0 })
              break
            }
          }
        })

        // Toggleable info overlay loading nfo.md
        let infoLoaded = false
        function openInfo() {
          infoPanel.classList.add('show')
          infoPanel.setAttribute('aria-hidden', 'false')
          if (!infoLoaded) {
            fetch('nfo.md')
              .then(r => r.text())
              .then(txt => {
                infoText.textContent = txt
                infoLoaded = true
              })
              .catch(() => {
                infoText.textContent = 'Info file not found.'
              })
          }
        }
        function closeInfo() {
          infoPanel.classList.remove('show')
          infoPanel.setAttribute('aria-hidden', 'true')
        }
        infoBtn.addEventListener('click', () => {
          if (infoPanel.classList.contains('show')) closeInfo()
          else openInfo()
        })
        infoPanel.addEventListener('click', e => {
          if (e.target === infoPanel) closeInfo()
        })
        window.addEventListener('keydown', e => {
          if (e.key === 'Escape') closeInfo()
        })

        resize()
        requestAnimationFrame(tick)
      })()
    </script>
  </body>
</html>
